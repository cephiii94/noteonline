/* style/style.css */

/* =========================================
   1. CSS VARIABLES & THEME CONFIGURATION
   (Pusat Kendali Warna - Ganti di sini, berubah semua!)
   ========================================= */
:root {
    /* -- Warna Dasar (Mode Terang) -- */
    --bg-body: #F8F9FD;        /* Soft blueish-white */
    --bg-surface: #FFFFFF;     /* Sidebar, Card, Modal, Header */
    --bg-hover: #f1f5f9;       /* Hover item, Search input */
    --bg-active: #EFF6FF;      /* Link aktif (biru muda) */
    
    /* -- Warna Teks -- */
    --text-main: #1f2937;      /* Hitam keabuan (Body) */
    --text-title: #1e293b;     /* Judul gelap */
    --text-muted: #64748b;     /* Teks keterangan/abu-abu */
    --text-light: #94a3b8;     /* Teks placeholder/tanggal */
    
    /* -- Warna Aksen & Border -- */
    --primary: #2563EB;        /* Biru Utama */
    --primary-hover: #1d4ed8;  /* Biru lebih gelap */
    --border-color: #E5E9F2;   /* Garis batas halus */
    --border-hover: #A8B8D8;   /* Garis batas saat di-hover */
    
    /* -- Warna Status/Tombol -- */
    --danger: #ef4444;         
    --danger-bg: #fee2e2;
    --warning: #eab308;
    --warning-bg: #fef9c3;
    --success: #15803d;
    --success-bg: #f0fdf4;
    
    /* -- Form Elements -- */
    --input-bg: #f1f5f9;
    --input-border: transparent;
    --input-focus: #3b82f6;
}

/* -- KONFIGURASI DARK MODE (Override Variable) -- */
body.dark-mode {
    --bg-body: #1e293b;        /* Slate-800 */
    --bg-surface: #334155;     /* Slate-700 */
    --bg-hover: #475569;       /* Slate-600 */
    --bg-active: #1e40af;      /* Biru gelap */
    
    --text-main: #cbd5e1;      /* Slate-300 */
    --text-title: #f1f5f9;     /* Putih tulang */
    --text-muted: #94a3b8;     /* Slate-400 */
    --text-light: #64748b;     
    
    --primary: #60a5fa;        /* Biru lebih terang biar kontras */
    --primary-hover: #93c5fd;
    --border-color: #475569;   /* Slate-600 */
    --border-hover: #64748b;
    
    --danger-bg: #7f1d1d;      /* Merah gelap */
    --warning-bg: #713f12;     /* Kuning/Coklat gelap */
    --success-bg: #14532d;     /* Hijau gelap */

    --input-bg: #475569;
    --input-border: #64748b;
}


/* =========================================
   2. PENGATURAN DASAR (RESET)
   ========================================= */
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-body);
    color: var(--text-main);
    transition: background-color 0.3s ease, color 0.3s ease;
}

a { text-decoration: none; color: inherit; }
button { cursor: pointer; font-family: inherit; border: none; background: none; }
input, select, textarea { font-family: inherit; width: 100%; }

/* Helper Classes */
.hidden { display: none !important; }


/* =========================================
   3. LAYOUT & SIDEBAR
   ========================================= */
.page-container { display: flex; height: 100vh; overflow: hidden; }

.sidebar {
    background-color: var(--bg-surface);
    border-right: 1px solid var(--border-color);
    width: 256px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    padding: 1.5rem;
    
    /* Mobile First: Hidden */
    position: fixed;
    height: 100%; /* Fallback */
    height: 100dvh; /* Modern Browser Fix */
    z-index: 30;
    transform: translateX(-100%);
    transition: transform 0.3s ease-in-out, background-color 0.3s;
    overflow-y: auto;
}

.sidebar.is-open { transform: translateX(0); }

.sidebar-logo {
    font-size: 1.5rem; font-weight: 700;
    color: var(--primary); /* Menggunakan variabel */
    margin-bottom: 2.5rem;
}

/* Navigasi */
.nav-menu { display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 1.5rem; }
.nav-menu-title {
    padding: 0 1rem; font-size: 0.75rem; font-weight: 600;
    color: var(--text-light); text-transform: uppercase; margin-bottom: 0.25rem;
}

/* Dropdown Kategori */
.nav-menu-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 0.25rem; cursor: pointer; padding: 0.25rem 0;
}
.nav-menu-toggle-btn {
    color: var(--text-light); width: 1.5rem; height: 1.5rem;
    display: flex; align-items: center; justify-content: center;
    border-radius: 0.25rem; transition: transform 0.2s ease;
}
.nav-menu-header:hover .nav-menu-toggle-btn {
    background-color: var(--bg-hover); color: var(--text-muted);
}
.nav-menu-toggle-btn.collapsed i { transform: rotate(-90deg); }

.nav-menu-list {
    max-height: 500px; overflow: hidden; transition: max-height 0.3s ease-out;
    display: flex; flex-direction: column; gap: 0.5rem;
}
.nav-menu-list.collapsed { max-height: 0; margin-top: -0.5rem; }

/* Link Navigasi */
.nav-link {
    display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 1rem;
    border-radius: 0.5rem; color: var(--text-main); transition: background-color 0.2s;
}
.nav-link:hover { background-color: var(--bg-hover); }
.nav-link .icon, .nav-link .emoji { width: 1.25rem; text-align: center; color: var(--text-muted); }

/* Active Link */
.active-link { background-color: var(--bg-active); color: var(--primary); font-weight: 600; }
.active-link .icon, .active-link span { color: var(--primary); }

/* Tombol Install PWA */
#installAppSidebarBtn { background-color: var(--success-bg); color: var(--success); }
#installAppSidebarBtn:hover { opacity: 0.8; }
#installAppSidebarBtn .icon { color: var(--success); }

/* Sidebar Footer & Dark Mode Toggle */
.sidebar-footer { margin-top: auto; text-align: center; font-size: 0.75rem; color: var(--text-light); }
.dark-mode-toggle {
    display: flex; justify-content: space-between; align-items: center;
    padding: 0.5rem 1rem; margin-bottom: 1rem; border-radius: 0.5rem;
    background-color: var(--bg-hover); cursor: pointer;
}
.dark-mode-label { font-size: 0.875rem; font-weight: 500; color: var(--text-main); }
.theme-toggle-btn { font-size: 1.125rem; color: var(--text-muted); pointer-events: none; }
.theme-toggle-btn .fa-sun { display: none; }
/* Logic ikon matahari/bulan ada di bagian bawah (Dark Mode Override) */

.sidebar-overlay {
    position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5);
    z-index: 20; display: none;
}
.sidebar-overlay.is-visible { display: block; }


/* =========================================
   4. MAIN CONTENT & HEADER
   ========================================= */
.main-content {
    flex: 1; display: flex; flex-direction: column;
    height: 100vh; overflow-y: auto; transition: margin-left 0.3s ease-in-out;
}

.header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color);
    background-color: var(--bg-surface); position: sticky; top: 0; z-index: 10; gap: 1rem;
}

.menu-toggle-btn { color: var(--text-muted); font-size: 1.25rem; margin-right: 0.5rem; }
.menu-toggle-btn:hover { color: var(--primary); }

/* Search Bar */
.search-bar { position: relative; display: none; } /* Mobile Hidden */
.search-bar .icon {
    position: absolute; left: 1rem; top: 50%; transform: translateY(-50%);
    color: var(--text-light); pointer-events: none;
}
.search-input {
    width: 100%; padding: 0.625rem 1rem 0.625rem 3rem;
    background-color: var(--input-bg); border-radius: 0.5rem;
    border: 2px solid var(--input-border); color: var(--text-main);
    transition: border-color 0.2s;
}
.search-input::placeholder { color: var(--text-light); }
.search-input:focus { outline: none; border-color: var(--input-focus); }

/* Search Bar Mobile (Fix) */
.search-bar-mobile { position: relative; flex: 1; display: block; }
.search-bar-mobile .icon {
    position: absolute; left: 1rem; top: 50%; transform: translateY(-50%);
    color: var(--text-light); z-index: 5; pointer-events: none;
}
.search-bar-mobile .search-input { padding-left: 3rem; }

/* User Info & Logout */
.header-right { display: flex; align-items: center; gap: 1rem; flex-shrink: 0; }
.user-info { font-size: 0.875rem; color: var(--text-muted); text-align: right; }
.user-info-name { font-weight: 600; display: none; color: var(--text-main); }
.user-info-email { font-size: 0.75rem; display: none; }

.logout-btn {
    background-color: var(--danger-bg); color: var(--danger);
    font-weight: 600; padding: 0.5rem 0.75rem; border-radius: 0.5rem;
    font-size: 0.875rem; display: flex; align-items: center; gap: 0.5rem;
}
.logout-btn:hover { opacity: 0.8; }
.logout-btn .text { display: none; }

.header-add-btn { display: none; padding-left: 1rem; padding-right: 1rem; }
.header-add-btn .text { display: none; }


/* =========================================
   5. NOTES AREA & GRID SYSTEM
   ========================================= */
.notes-area { padding: 1.5rem; flex: 1; }
.notes-header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
.notes-title { font-size: 1.5rem; font-weight: 700; color: var(--text-title); }

/* Tombol Toggle View Grid/List */
.view-toggle-buttons {
    display: flex; background-color: var(--bg-hover);
    border-radius: 0.5rem; padding: 0.25rem;
}
.view-toggle-btn {
    padding: 0.5rem 0.75rem; font-size: 0.875rem; color: var(--text-muted);
    border-radius: 0.375rem; line-height: 1;
}
.view-toggle-btn.active {
    background-color: var(--bg-surface); color: var(--primary);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* --- GRID SYSTEM (REVISI PENTING) --- */
.notes-grid {
    display: grid;
    /* Auto Fill dengan Minmax: Anti Gepeng! */
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem; width: 100%;
}
.notes-empty-message { color: var(--text-muted); text-align: center; padding: 2.5rem 0; }


/* =========================================
   6. CARD STYLE
   ========================================= */
.note-card {
    background-color: var(--bg-surface);
    border: 1px solid var(--border-color);
    transition: all 0.3s ease; cursor: pointer;
    border-radius: 0.75rem; padding: 1.25rem;
    display: flex; flex-direction: column; justify-content: space-between;
    position: relative;
}
.note-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
    border-color: var(--border-hover);
}

.note-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
.note-card-category { font-size: 0.875rem; font-weight: 600; color: var(--primary); }
.note-card-date { font-size: 0.75rem; color: var(--text-light); }
.note-card-title {
    font-size: 1.125rem; font-weight: 700; color: var(--text-title);
    margin-bottom: 0.5rem; word-break: break-word; padding-right: 2rem;
}
.note-card-content {
    color: var(--text-muted); font-size: 0.875rem;
    word-break: break-word; overflow: hidden; text-overflow: ellipsis;
    display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;
}

.note-card-footer {
    padding-top: 1rem; margin-top: 1rem; border-top: 1px solid var(--border-color);
}
.note-card-tags { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem; }
.note-tag {
    background-color: #e0e7ff; color: #4338ca; /* Hardcoded soft indigo is ok for tags */
    font-size: 0.75rem; font-weight: 500; padding: 0.125rem 0.625rem;
    border-radius: 9999px;
}
/* Override Tag di Dark Mode biar gak silau */
body.dark-mode .note-tag { background-color: #3730a3; color: #c7d2fe; }

.note-card-actions { display: flex; justify-content: flex-end; gap: 0.5rem; }
.note-action-btn {
    width: 2rem; height: 2rem; border-radius: 9999px;
    display: flex; align-items: center; justify-content: center;
    transition: background-color 0.2s; color: var(--text-muted);
}

/* Warna Tombol Aksi */
.note-action-btn.edit-btn:hover { color: var(--warning); background-color: var(--warning-bg); }
.note-action-btn.delete-btn:hover { color: var(--danger); background-color: var(--danger-bg); }
.note-action-btn.pin-btn:hover, .note-action-btn.pin-btn.active {
    color: var(--primary); background-color: var(--bg-active);
}
.note-action-btn.archive-btn:hover, .note-action-btn.unarchive-btn:hover {
    color: var(--warning); background-color: var(--warning-bg);
}

/* Style Pinned Card */
.note-card.is-pinned {
    background-color: var(--warning-bg); border-color: var(--warning);
}
/* Override Pinned di Dark Mode */
body.dark-mode .note-card.is-pinned {
    background-color: #422006; border-color: #b45309;
}


/* --- Tampilan List Mode (Fitur 3) --- */
.notes-grid.notes-list-mode {
    grid-template-columns: 1fr !important; /* Paksa 1 kolom */
    gap: 0.5rem;
}
.notes-list-mode .note-card {
    flex-direction: row; align-items: center; padding: 0.75rem 1.25rem;
}
.notes-list-mode .note-card-content,
.notes-list-mode .note-card-tags,
.notes-list-mode .note-card-footer,
.notes-list-mode .note-card-date { display: none; }

.notes-list-mode .note-card-footer {
    display: block; padding: 0; margin: 0; border: none;
}
.notes-list-mode .note-card-body { flex-grow: 1; }
.notes-list-mode .note-card-header { margin: 0; }
.notes-list-mode .note-card-title { margin: 0; font-size: 1rem; padding-right: 0.5rem; }


/* =========================================
   7. MODAL & FORM
   ========================================= */
.modal-overlay {
    position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5);
    display: flex; align-items: center; justify-content: center; padding: 1rem;
    z-index: 50; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s;
}
.modal-overlay.is-visible { opacity: 1; visibility: visible; }

.modal-content {
    background-color: var(--bg-surface); border-radius: 1rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    width: 100%; max-width: 672px; display: flex; flex-direction: column;
    max-height: 90vh; transform: scale(0.95); opacity: 0;
    transition: transform 0.2s ease, opacity 0.2s ease;
}
.modal-overlay.is-visible .modal-content { transform: scale(1); opacity: 1; }

.modal-header {
    flex-shrink: 0; padding: 1.5rem; border-bottom: 1px solid var(--border-color);
}
.modal-header h2 { font-size: 1.5rem; font-weight: 600; color: var(--primary); }

.modal-body { flex: 1; overflow-y: auto; padding: 1.5rem; }
.modal-footer {
    flex-shrink: 0; display: flex; justify-content: flex-end; gap: 1rem;
    padding: 1.5rem; border-top: 1px solid var(--border-color);
}

/* Form Styles */
.form-input {
    width: 100%; padding: 0.75rem 1rem; margin-bottom: 1rem;
    border: 1px solid var(--border-color); background-color: var(--input-bg);
    color: var(--text-main); border-radius: 0.5rem; transition: all 0.2s ease;
}
.form-input:focus {
    outline: none; border-color: var(--input-focus);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.4);
}
.form-grid { display: grid; grid-template-columns: 1fr; gap: 1rem; }

/* Buttons */
.btn {
    font-weight: 700; padding: 0.5rem 1.5rem; border-radius: 0.5rem;
    transition: background-color 0.2s; font-size: 0.875rem;
}
.btn-primary { background-color: var(--primary); color: white; }
.btn-primary:hover { background-color: var(--primary-hover); }
.btn-secondary { background-color: var(--bg-hover); color: var(--text-main); }
.btn-secondary:hover { opacity: 0.8; }
.btn-danger { background-color: var(--danger); color: white; }
.btn-danger:hover { opacity: 0.9; }

/* FAB (Floating Action Button) */
.fab-add, #editFab {
    position: fixed; bottom: 1.5rem; right: 1.5rem;
    width: 3.5rem; height: 3.5rem; border-radius: 9999px;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: all 0.2s ease; z-index: 20; color: white;
}
.fab-add { background-color: var(--primary); }
.fab-add:hover { transform: scale(1.1); background-color: var(--primary-hover); }

#editFab { background-color: var(--warning); width: 3rem; height: 3rem; position: absolute; }
#editFab:hover { transform: scale(1.1); opacity: 0.9; }

/* FAB Mobile Visibility */
.fab-mobile-only { display: flex; }


/* =========================================
   8. VIEW MODAL (DETAIL)
   ========================================= */
#viewModal .modal-header {
    display: flex; justify-content: space-between; align-items: flex-start;
}
.view-title-group h2 { font-size: 1.5rem; font-weight: 700; color: var(--text-title); margin-bottom: 0.25rem; }
.view-title-group p { font-size: 0.875rem; color: var(--text-muted); }

.modal-icon-btn, .modal-close-btn {
    color: var(--text-muted); width: 2.5rem; height: 2.5rem;
    border-radius: 9999px; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s; flex-shrink: 0;
}
.modal-icon-btn:hover, .modal-close-btn:hover {
    color: var(--text-main); background-color: var(--bg-hover);
}
#viewHeaderDeleteBtn:hover { color: var(--danger); background-color: var(--danger-bg); }

/* Tombol Arsip di Modal */
#viewHeaderArchiveBtn:hover, #viewMenuArchive:hover,
#viewHeaderUnarchiveBtn:hover, #viewMenuUnarchive:hover {
    color: var(--warning); background-color: var(--warning-bg);
}

.view-meta-group { display: flex; align-items: center; gap: 1rem; margin-top: 1rem; font-size: 0.875rem; }
#viewNoteCategory {
    font-weight: 600; color: var(--primary); background-color: var(--bg-active);
    padding: 0.25rem 0.75rem; border-radius: 9999px;
}
#viewNoteTags { display: flex; flex-wrap: wrap; gap: 0.5rem; }

#viewNoteContent { color: var(--text-main); padding: 1.5rem; }
#productLinkContainer { padding: 1.5rem; border-top: 1px solid var(--border-color); }
#productLinkContainer p { font-size: 0.75rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; margin-bottom: 0.5rem; }
#viewProductLink { color: var(--primary); text-decoration: underline; }

/* Dropdown Menu Modal (Mobile) */
.view-dropdown-menu {
    position: absolute; top: 3.5rem; right: 0.5rem;
    background-color: var(--bg-surface); border-radius: 0.5rem;
    border: 1px solid var(--border-color); box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    z-index: 60; display: none; padding: 0.5rem 0; min-width: 180px;
}
.view-dropdown-menu.is-visible { display: block; }
.view-dropdown-item {
    display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1.5rem;
    width: 100%; text-align: left; font-size: 1rem; color: var(--text-main);
}
.view-dropdown-item:hover { background-color: var(--bg-hover); }
.view-dropdown-item.danger { color: var(--danger); }

/* Rich Text Editor Overrides */
.ql-toolbar, .ql-editor { border-color: var(--border-color) !important; }
body.dark-mode .ql-toolbar, body.dark-mode .ql-editor { background-color: var(--bg-hover); color: var(--text-main); }
body.dark-mode .ql-snow .ql-stroke { stroke: var(--text-muted); }
body.dark-mode .ql-snow .ql-picker-label { color: var(--text-muted); }
.text-link { color: var(--primary); text-decoration: underline; }

/* Default: Sembunyikan Footer Modal (muncul hanya di desktop nanti) */
.view-modal-footer { display: none; }


/* =========================================
   9. MEDIA QUERIES & RESPONSIF
   ========================================= */

/* Tablet (sm) */
@media (min-width: 640px) {
    .search-bar { display: block; }
    .search-bar-mobile { display: none; }
    .user-info-email { display: block; }
    .logout-btn .text { display: inline; }
}

/* Desktop (md) */
/* Tampilan Desktop (md) */
@media (min-width: 768px) {
    /* 1. Reset Header karena tombol burger pindah */
    .header-left {
        padding-left: 0; /* Hapus padding bekas tombol */
    }
    
    /* 2. Konfigurasi Sidebar Desktop */
    .sidebar {
        position: relative;
        transform: none;
        z-index: 10;
        margin-left: 0;
        
        /* Animasi lebar sidebar */
        width: 256px; 
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        overflow-x: hidden; /* Mencegah scroll horizontal saat animasi */
    }

    /* --- LOGIKA MINI SIDEBAR (COLLAPSED) --- */
    
    /* Saat Collapsed: Lebar jadi kecil (bukan hilang) */
    .sidebar.is-collapsed {
        width: 80px; /* Lebar ikon */
        margin-left: 0; /* JANGAN -256px lagi */
        padding: 1.5rem 1rem; /* Kurangi padding kiri-kanan */
    }

    /* Saat Collapsed: Sembunyikan Logo Teks */
    .sidebar.is-collapsed .sidebar-logo {
        display: none;
    }
    
    /* Saat Collapsed: Burger Button di tengah */
    .sidebar.is-collapsed .sidebar-top-section {
        justify-content: center !important;
        margin-bottom: 2rem;
    }

    /* Saat Collapsed: Sembunyikan Judul Menu & Footer */
    .sidebar.is-collapsed .nav-menu-title,
    .sidebar.is-collapsed .sidebar-footer,
    .sidebar.is-collapsed .nav-menu-header, /* Hide header kategori */
    .sidebar.is-collapsed #installAppContainer {
        display: none;
    }
    
    /* Saat Collapsed: Pastikan list kategori tetap muncul (override collapsed js) */
    .sidebar.is-collapsed .nav-menu-list {
        max-height: unset !important; /* Paksa tampil */
    }

    /* --- TOOLTIP HOVER EFFECT --- */

    /* Saat Collapsed: Link Navigasi */
    .sidebar.is-collapsed .nav-link {
        justify-content: center; /* Ikon di tengah */
        padding: 0.75rem; /* Padding kotak */
        position: relative; /* Jangkar untuk tooltip */
    }

    /* Saat Collapsed: Sembunyikan Teks Link (span) */
    .sidebar.is-collapsed .nav-link span:not(.emoji) {
        display: none;
    }
    
    /* Saat Collapsed: Icon sedikit diperbesar biar gagah */
    .sidebar.is-collapsed .nav-link .icon,
    .sidebar.is-collapsed .nav-link .emoji {
        font-size: 1.25rem;
        margin: 0;
    }

    /* ✨ THE MAGIC TOOLTIP: Muncul saat Hover di mode Mini ✨ */
    .sidebar.is-collapsed .nav-link:hover span:not(.emoji) {
        display: block;
        position: absolute;
        left: 100%; /* Muncul di sebelah kanan ikon */
        top: 50%;
        transform: translateY(-50%);
        
        /* Style Tooltip */
        background-color: var(--text-title); /* Gelap/Terang ikut tema */
        color: var(--bg-surface); /* Teks kontras */
        
        padding: 0.5rem 0.75rem;
        border-radius: 0.375rem;
        white-space: nowrap; /* Teks satu baris */
        z-index: 100;
        margin-left: 12px; /* Jarak dari ikon */
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        font-size: 0.875rem;
        font-weight: 500;
        pointer-events: none; /* Biar gak kedip-kedip */
    }
    
    /* Panah kecil pada tooltip */
    .sidebar.is-collapsed .nav-link:hover span:not(.emoji)::before {
        content: "";
        position: absolute;
        left: -5px;
        top: 50%;
        transform: translateY(-50%);
        border-width: 5px;
        border-style: solid;
        border-color: transparent var(--text-title) transparent transparent;
    }

    /* --- Pengaturan Lain --- */
    .sidebar-overlay { display: none !important; }
    .search-bar { width: 24rem; }
    .form-grid { grid-template-columns: repeat(2, 1fr); }
    .form-grid-span-2 { grid-column: span 2 / span 2; }
    .user-info-name { display: block; }
    .header-add-btn { display: flex; }
    .header-add-btn .text { display: inline; }
    .fab-mobile-only { display: none; }
    
    /* Tombol Modal Desktop */
    .desktop-only { display: none !important; }
    .desktop-only-flex { display: flex; }
    #viewMenuBtn { display: none !important; }
    .view-dropdown-menu { display: none !important; }

    /* 1. Tampilkan Footer Barunya */
    .view-modal-footer {
        display: flex !important; /* Paksa muncul */
        justify-content: space-between;
        align-items: center;
        padding: 1rem 1.5rem;
        border-top: 1px solid var(--border-color);
        background-color: var(--bg-surface);
        /* Pastikan footer nempel di bawah */
        margin-top: auto; 
    }

    /* Style container tombol biar rapi */
    .note-action-group {
        display: flex;
        gap: 0.75rem; /* Jarak antar ikon */
    }

    /* Style Ikon di Footer (Mengikuti style note-action-btn yang sudah ada) */
    .view-modal-footer .note-action-btn {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 0.5rem; /* Sedikit kotak biar beda dikit dari yang bulat */
        font-size: 1rem;
        background-color: var(--bg-hover); /* Background tipis */
    }
    
    /* Hover effects (Reuse variable warna) */
    .view-modal-footer .edit-btn:hover { color: var(--warning); background-color: var(--warning-bg); }
    .view-modal-footer .delete-btn:hover { color: var(--danger); background-color: var(--danger-bg); }
    .view-modal-footer .archive-btn:hover { color: var(--primary); background-color: var(--bg-active); }

    /* 2. BERSIHKAN HEADER (Sembunyikan tombol header di Desktop) */
    #viewHeaderEditBtn, 
    #viewHeaderDeleteBtn,
    #viewHeaderArchiveBtn,
    #viewHeaderUnarchiveBtn,
    #editFab { /* Sembunyikan juga tombol melayang (FAB) */
        display: none !important;
    }
    
    /* Tombol Menu (Titik Tiga) juga sembunyikan di Desktop */
    #viewMenuBtn { display: none !important; }
}

/* Mobile (< 767px) */
@media (max-width: 767px) {
    
    /* 1. Reset Overlay: Hilangkan padding pembungkus biar mepet pinggir */
    .modal-overlay {
        padding: 0 !important;
        align-items: flex-end; /* Opsional: animasi muncul dari bawah terlihat lebih natural */
    }

    /* 2. Modal Content: Paksa Full Screen Total */
    .modal-content {
        width: 100% !important;
        max-width: 100% !important;
        
        /* PENTING: Gunakan 100dvh agar pas dengan tinggi layar HP + Address Bar */
        height: 100dvh !important; 
        max-height: 100dvh !important;
        
        border-radius: 0 !important; /* Hilangkan sudut bulat */
        border: none !important;
        
        display: flex;
        flex-direction: column;
    }

    /* 3. Penyesuaian Header Modal di HP */
    .view-modal-header {
        padding: 0.75rem 1rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        flex-wrap: wrap;
        justify-content: flex-start;
        flex-shrink: 0; /* Header tidak boleh gepeng */
    }

    /* 4. Penyesuaian Body Modal (Area Scroll) */
    .modal-body {
        padding: 1rem;
        padding-top: 0.5rem;
        flex: 1; /* Ambil sisa ruang */
        overflow-y: auto; /* Scroll hanya di bagian isi */
    }

    /* --- Tombol & Elemen Lain di HP --- */
    #viewHeaderEditBtn { margin-left: auto; }
    
    .view-dropdown-menu { 
        max-width: 200px; 
        z-index: 100;
        top: 3rem; /* Sesuaikan posisi dropdown */
        right: 0.5rem;
    }
    
    .view-modal-header .view-title-group {
        flex-basis: 100%;
        order: 3;
        text-align: left;
        padding: 0 0.5rem;
        margin-top: 0.5rem;
    }
    
    .view-meta-group { 
        padding: 0 1rem 1rem 1rem; 
        flex-shrink: 0;
    }
    
    /* Sembunyikan elemen Desktop */
    .desktop-only { display: none !important; }
    .desktop-only-flex { display: none; }

    #viewHeaderArchiveBtn, 
    #viewHeaderUnarchiveBtn {
        display: none !important;
    }
}

/* Mobile Font Size Adjustment */
@media (max-width: 640px) {
    .notes-title { font-size: 1.25rem; }
    .note-card-title { font-size: 1rem; line-height: 1.4; }
    .note-card-content { font-size: 0.8125rem; }
    .header { padding: 0.75rem 1rem; gap: 0.5rem; }
    .search-bar-mobile { width: 100%; margin: 0 0.5rem; }
}

/* Default (Tampilan Mobile): Tampilkan tombol header, Sembunyikan tombol sidebar */
.mobile-visible { display: block; }
.desktop-visible { display: none; }

/* Tampilan Desktop (Layar >= 768px): Balik kondisinya */
@media (min-width: 768px) {
    .mobile-visible { display: none; } /* Sembunyikan tombol header */
    .desktop-visible { display: block; } /* Tampilkan tombol sidebar */
    
    /* Kembalikan padding header kiri yang tadi sempat kita hapus */
    .header-left { padding-left: 0; }
}

/* Logic Dark Mode: Ikon */
body.dark-mode .theme-toggle-btn .fa-sun { display: block; color: var(--warning); }
body.dark-mode .theme-toggle-btn .fa-moon { display: none; }